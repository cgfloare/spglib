<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Magnetic Space group (MSG) &#8212; Spglig v.1.16.0</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-sphinx.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Definitions and conventions" href="definition.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          spglib</a>
        <span class="navbar-text navbar-version pull-left"><b>1.16</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">How to install spglib C-API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">C-APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Spglib dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="variable.html">Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="python-spglib.html">Python interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface.html">Rust, Fortran, and Ruby interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="definition.html">Definitions and conventions</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Magnetic space group</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Magnetic Space group (MSG)</a><ul>
<li><a class="reference internal" href="#definition">Definition</a></li>
<li><a class="reference internal" href="#action-of-msg-operations">Action of MSG operations</a></li>
<li><a class="reference internal" href="#msg-detection-for-crystal-structure">MSG detection for crystal structure</a><ul>
<li><a class="reference internal" href="#procedure-to-detect-msg-operations">Procedure to detect MSG operations</a></li>
<li><a class="reference internal" href="#procedure-to-standardize-msg-setting">Procedure to standardize MSG setting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#transformation-of-space-group-mathcal-g">Transformation of space group <span class="math notranslate nohighlight">\(\mathcal{G}\)</span></a></li>
<li><a class="reference internal" href="#transformation-of-magnetic-space-group-mathcal-m">Transformation of magnetic space group <span class="math notranslate nohighlight">\(\mathcal{M}\)</span></a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="magnetic-space-group-msg">
<h1><a class="toc-backref" href="#id2">Magnetic Space group (MSG)</a><a class="headerlink" href="#magnetic-space-group-msg" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#magnetic-space-group-msg" id="id2">Magnetic Space group (MSG)</a></p>
<ul>
<li><p><a class="reference internal" href="#definition" id="id3">Definition</a></p></li>
<li><p><a class="reference internal" href="#action-of-msg-operations" id="id4">Action of MSG operations</a></p></li>
<li><p><a class="reference internal" href="#msg-detection-for-crystal-structure" id="id5">MSG detection for crystal structure</a></p>
<ul>
<li><p><a class="reference internal" href="#procedure-to-detect-msg-operations" id="id6">Procedure to detect MSG operations</a></p></li>
<li><p><a class="reference internal" href="#procedure-to-standardize-msg-setting" id="id7">Procedure to standardize MSG setting</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#transformation-of-space-group-mathcal-g" id="id8">Transformation of space group <span class="math notranslate nohighlight">\(\mathcal{G}\)</span></a></p></li>
<li><p><a class="reference internal" href="#transformation-of-magnetic-space-group-mathcal-m" id="id9">Transformation of magnetic space group <span class="math notranslate nohighlight">\(\mathcal{M}\)</span></a></p></li>
<li><p><a class="reference internal" href="#references" id="id10">References</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="definition">
<h2><a class="toc-backref" href="#id3">Definition</a><a class="headerlink" href="#definition" title="Permalink to this headline">¶</a></h2>
<p>A <strong>magnetic space group</strong> <span class="math notranslate nohighlight">\(\mathcal{M}\)</span> is a subgroup of direct product of space group <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> and <span class="math notranslate nohighlight">\(\mathbb{Z}_{2} \simeq \{1, 1' \}\)</span>.</p>
<p>A <strong>family space group</strong> (FSG) <span class="math notranslate nohighlight">\(\mathcal{F}(\mathcal{M})\)</span> is a non-magnetic space group obtained by ignoring primes in operations,</p>
<div class="math notranslate nohighlight">
\[\mathcal{F}(\mathcal{M}) = \left\{ (\mathbf{R}, \mathbf{v}) \mid (\mathbf{R}, \mathbf{v}) \in \mathcal{M} \vee (\mathbf{R}, \mathbf{v})1' \in \mathcal{M} \right\}.\]</div>
<p>A <strong>maximal space subgroup</strong> (XSG) <span class="math notranslate nohighlight">\(\mathcal{D}(\mathcal{M})\)</span> is a space group obtained by removing primed operations,</p>
<div class="math notranslate nohighlight">
\[\mathcal{D}(\mathcal{M}) = \left\{ (\mathbf{R}, \mathbf{v}) \mid (\mathbf{R}, \mathbf{v}) \in \mathcal{M} \right\}.\]</div>
<p>Magnetic space groups are classified to the following four types:</p>
<ul>
<li><p>(type-I) <span class="math notranslate nohighlight">\(\mathcal{M} \simeq \mathcal{F}(\mathcal{M}) \simeq \mathcal{D}(\mathcal{M})\)</span>.</p></li>
<li><p>(type-II) <span class="math notranslate nohighlight">\(\mathcal{M} \simeq \mathcal{F}(\mathcal{M}) \times \{1, 1'\}, \mathcal{F}(\mathcal{M}) \simeq \mathcal{D}(\mathcal{M})\)</span>.</p></li>
<li><p>(type-III)
<span class="math notranslate nohighlight">\(\mathcal{D}(\mathcal{M})\)</span> is a translationengleiche subgroup of index two of <span class="math notranslate nohighlight">\(\mathcal{F}(\mathcal{M})\)</span>.</p>
<div class="math notranslate nohighlight">
\[\mathcal{M} \simeq \mathcal{D}(\mathcal{M}) \sqcup (\mathcal{F}(\mathcal{M}) \backslash \mathcal{D}(\mathcal{M})) 1'\]</div>
</li>
<li><p>(type-IV)
<span class="math notranslate nohighlight">\(\mathcal{D}(\mathcal{M})\)</span> is a klessengleichesubgroup of index two of <span class="math notranslate nohighlight">\(\mathcal{F}(\mathcal{M})\)</span>.</p>
<div class="math notranslate nohighlight">
\[\mathcal{M} \simeq \mathcal{D}(\mathcal{M}) \sqcup (\mathcal{F}(\mathcal{M}) \backslash \mathcal{D}(\mathcal{M})) 1'\]</div>
</li>
</ul>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Number of (3-dimensional) magnetic space groups</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>type-I</p></th>
<th class="head"><p>type-II</p></th>
<th class="head"><p>type-III</p></th>
<th class="head"><p>type-IV</p></th>
<th class="head"><p>Total</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>230</p></td>
<td><p>230</p></td>
<td><p>674</p></td>
<td><p>517</p></td>
<td><p>1651</p></td>
</tr>
</tbody>
</table>
<p>For type-I, II, III MSG, both OG and BNS symbols use a setting of <span class="math notranslate nohighlight">\(\mathcal{F}(\mathcal{M})\)</span>.
For type-IV MSG, OG symbols use a setting of <span class="math notranslate nohighlight">\(\mathcal{F}(\mathcal{M})\)</span> and BNS symbols use that of <span class="math notranslate nohighlight">\(\mathcal{D}(\mathcal{M})\)</span>.</p>
</div>
<div class="section" id="action-of-msg-operations">
<h2><a class="toc-backref" href="#id4">Action of MSG operations</a><a class="headerlink" href="#action-of-msg-operations" title="Permalink to this headline">¶</a></h2>
<p>In general, we can arbitrarily choose how MSG operation acts on objects as long as it satisfies the definition of left actions.
Here are the examples of objects and actions on them:</p>
<ul class="simple">
<li><p>Collinear magnetic moment <span class="math notranslate nohighlight">\(m_{z}\)</span> without spin-orbit coupling</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}(\mathbf{R}, \mathbf{v}) \circ m_{z} &amp;= m_{z} \\
1' \circ m_{z} &amp;= -m_{z}\end{split}\]</div>
<ul class="simple">
<li><p>Magnetic moment <span class="math notranslate nohighlight">\(\mathbf{m}\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}(\mathbf{R}, \mathbf{v}) \circ \mathbf{m} &amp;= (\mathrm{det} \mathbf{R}) \mathbf{R} \mathbf{m} \\
1' \circ \mathbf{m} &amp;= -\mathbf{m}\end{split}\]</div>
<ul class="simple">
<li><p>Grain boundary made of “black” and “white” crystals</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}(\mathbf{R}, \mathbf{v}) \circ (\mathbf{r}, \mathrm{black}) &amp;= ( \mathbf{R}\mathbf{r} + \mathbf{v}, \mathrm{black} ) \\
(\mathbf{R}, \mathbf{v}) \circ (\mathbf{r}, \mathrm{white}) &amp;= ( \mathbf{R}\mathbf{r} + \mathbf{v}, \mathrm{white} ) \\
1' \circ (\mathbf{r}, \mathrm{black}) &amp;= (\mathbf{r}, \mathrm{white}) \\
1' \circ (\mathbf{r}, \mathrm{white}) &amp;= (\mathbf{r}, \mathrm{black}) \\\end{split}\]</div>
</div>
<div class="section" id="msg-detection-for-crystal-structure">
<h2><a class="toc-backref" href="#id5">MSG detection for crystal structure</a><a class="headerlink" href="#msg-detection-for-crystal-structure" title="Permalink to this headline">¶</a></h2>
<p>Formally, <code class="code docutils literal notranslate"><span class="pre">cell</span></code> consists of</p>
<ul class="simple">
<li><p>column-wise lattice matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span></p></li>
<li><p>fractional coordinates <span class="math notranslate nohighlight">\(\mathbf{X}\)</span></p></li>
<li><p>atomic types <span class="math notranslate nohighlight">\(\mathbf{T}\)</span></p></li>
<li><p>magmoms <span class="math notranslate nohighlight">\(\mathbf{M}\)</span></p></li>
</ul>
<p>SG corresponds to the following equivalence relation (implemented in <code class="code docutils literal notranslate"><span class="pre">cel_is_overlap_with_same_type</span></code>) as <span class="math notranslate nohighlight">\(\mathcal{S} := \mathrm{Stab}_{\mathrm{E}(3)} \, (\mathbf{X}, \mathbf{T}) / \sim_{\mathcal{S}}\)</span>,</p>
<div class="math notranslate nohighlight">
\[(X_{i}, T_{i}) \sim_{\mathcal{S}} (X_{j}, T_{j})
\overset{\mathrm{def}}{\iff}
\exists g \in \mathrm{E}(3) \, s.t. \,  g \circ X_{i} = X_{j} \,\mathrm{and}\,  T_{i} = T_{j}.\]</div>
<p>XSG corresponds to the following equivalence relation as <span class="math notranslate nohighlight">\(\mathcal{D} := \mathrm{Stab}_{ \mathcal{S} } \, (\mathbf{X}, \mathbf{T}, \mathbf{M}) / \sim_{\mathcal{D}}\)</span>,</p>
<div class="math notranslate nohighlight">
\[(X_{i}, T_{i}, M_{i}) \sim_{\mathcal{D}} (X_{j}, T_{j}, M_{j})
\overset{\mathrm{def}}{\iff}
\exists g \in \mathcal{S} \, s.t. \, g \circ M_{i} = M_{j}.\]</div>
<p>MSG corresponds to the following equivalence relation as <span class="math notranslate nohighlight">\(\mathcal{M} = \mathrm{Stab}_{ \mathcal{S} \times \{ 1, 1' \} } \, (\mathbf{X}, \mathbf{T}, \mathbf{M}) / \sim_{\mathcal{M}}\)</span></p>
<div class="math notranslate nohighlight">
\[(X_{i}, T_{i}, M_{i}) \sim_{\mathcal{M}} (X_{j}, T_{j}, M_{j})
\overset{\mathrm{def}}{\iff}
\exists g\theta \in \mathcal{S} \times \{ 1, 1' \} \, s.t. \, g \theta \circ M_{i} = M_{j}\]</div>
<p><span class="math notranslate nohighlight">\(\mathcal{S}\)</span> may not be index-two supergroup of <span class="math notranslate nohighlight">\(\mathcal{D}\)</span> because the former ignores magmom configurations.
Thus, we compute FSG via MSG as <span class="math notranslate nohighlight">\(\mathcal{F} := \mathcal{M}  / \{ 1, 1' \}\)</span>.</p>
<div class="section" id="procedure-to-detect-msg-operations">
<h3><a class="toc-backref" href="#id6">Procedure to detect MSG operations</a><a class="headerlink" href="#procedure-to-detect-msg-operations" title="Permalink to this headline">¶</a></h3>
<p>In actual implementation in <code class="code docutils literal notranslate"><span class="pre">spn_get_operations_with_site_tensors</span></code>, the following steps two, three, and four are performed at the same time.</p>
<ol class="arabic simple">
<li><p>Compute SG <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> by just ignoring magmoms.</p></li>
<li><p>Compute XSG <span class="math notranslate nohighlight">\(\mathcal{D}\)</span> by checking <span class="math notranslate nohighlight">\(g \circ M_{i} = M_{g \circ i}\)</span> one by one for <span class="math notranslate nohighlight">\(g \in \mathcal{S}\)</span>.</p></li>
<li><p>Compute MSG <span class="math notranslate nohighlight">\(\mathcal{M}\)</span> by checking <span class="math notranslate nohighlight">\(g \theta \circ M_{i} = M_{g \circ i}\)</span> one by one for <span class="math notranslate nohighlight">\(g \theta \in \mathcal{S} \times \{ 1, 1' \}\)</span>.</p></li>
<li><p>Compute FSG <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> by ignoring primes in <span class="math notranslate nohighlight">\(\mathcal{M}\)</span></p></li>
</ol>
<p>In <code class="code docutils literal notranslate"><span class="pre">spgat_get_symmetry_with_site_tensors</span></code>, <code class="code docutils literal notranslate"><span class="pre">sym_nonspin</span></code> corresponds to <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>.
Then, <code class="code docutils literal notranslate"><span class="pre">spn_get_operations_with_site_tensors</span></code> computes <span class="math notranslate nohighlight">\(\mathcal{M}\)</span> under the following actions:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="code docutils literal notranslate"><span class="pre">tensor_rank=0</span></code></dt><dd><ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">is_magnetic=true</span></code>: <span class="math notranslate nohighlight">\(1' \circ m = -m, (\mathbf{R}, \mathbf{v}) \circ m = m\)</span></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">is_magnetic=false</span></code>: <span class="math notranslate nohighlight">\(1' \circ m_{z} = m_{z}, (\mathbf{R}, \mathbf{v}) \circ m = m\)</span></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="code docutils literal notranslate"><span class="pre">tensor_rank=1</span></code> (currently only support axial vector)</dt><dd><ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">is_magnetic=true</span></code>: <span class="math notranslate nohighlight">\(1' \circ \mathbf{m} = -\mathbf{m}, (\mathbf{R}, \mathbf{v}) \circ \mathbf{m} = (\mathrm{det} \mathbf{R}) \mathbf{R} \mathbf{m}\)</span></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">is_magnetic=false</span></code>: <span class="math notranslate nohighlight">\(1' \circ \mathbf{m} = \mathbf{m}, (\mathbf{R}, \mathbf{v}) \circ \mathbf{m} = (\mathrm{det} \mathbf{R}) \mathbf{R} \mathbf{m}\)</span></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="procedure-to-standardize-msg-setting">
<h3><a class="toc-backref" href="#id7">Procedure to standardize MSG setting</a><a class="headerlink" href="#procedure-to-standardize-msg-setting" title="Permalink to this headline">¶</a></h3>
<p><code class="code docutils literal notranslate"><span class="pre">spglib.c:get_magnetic_dataset</span></code></p>
<ol class="arabic simple">
<li><dl class="simple">
<dt>Determine type of MSG</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>When <span class="math notranslate nohighlight">\([\mathcal{F}:\mathcal{D}] = 1\)</span></dt><dd><ul>
<li><p><span class="math notranslate nohighlight">\([\mathcal{M}:\mathcal{F}] = 1\)</span> -&gt; Type-I</p></li>
<li><p><span class="math notranslate nohighlight">\([\mathcal{M}:\mathcal{F}] = 2\)</span> -&gt; Type-II</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>When <span class="math notranslate nohighlight">\([\mathcal{F}:\mathcal{D}] = 2\)</span></dt><dd><ul>
<li><p>Find a coset decomposition <span class="math notranslate nohighlight">\(\mathcal{M} = \mathcal{D} \sqcup g \mathcal{D}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(g\)</span> is not translation -&gt; Type-III</p></li>
<li><p><span class="math notranslate nohighlight">\(g\)</span> is translation -&gt; Type-IV</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Choose reference setting</dt><dd><ul class="simple">
<li><p>Type-I, II, III -&gt; Hall symbol of <span class="math notranslate nohighlight">\(\mathcal{F}\)</span></p></li>
<li><p>Type-IV -&gt; Hall symbol of <span class="math notranslate nohighlight">\(\mathcal{D}\)</span></p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Compare <span class="math notranslate nohighlight">\(\mathcal{M}\)</span> with MSGs in database after applying a transformation to the Hall symbol’s setting</p></li>
<li><p>Standardize cell</p></li>
</ol>
</div>
</div>
<div class="section" id="transformation-of-space-group-mathcal-g">
<h2><a class="toc-backref" href="#id8">Transformation of space group <span class="math notranslate nohighlight">\(\mathcal{G}\)</span></a><a class="headerlink" href="#transformation-of-space-group-mathcal-g" title="Permalink to this headline">¶</a></h2>
<p>We denote a primitive lattice as <span class="math notranslate nohighlight">\(L_{\mathrm{prim}}\)</span> and a conventional lattice as <span class="math notranslate nohighlight">\(L_{\mathrm{conv}}\)</span>.
Here the centering vectors correspond to <span class="math notranslate nohighlight">\(L_{\mathrm{conv}} / L_{\mathrm{prim}}\)</span>.
For example, trigonal space groups with hexagonal cell (obverse) give</p>
<div class="math notranslate nohighlight">
\[L_{\mathrm{conv}} / L_{\mathrm{prim}} =
\left\{
    (0, 0, 0),
    (2/3, 1/3, 1/3),
    (1/3, 2/3, 2/3)
\right\}.\]</div>
<p>We write translation group formed by <span class="math notranslate nohighlight">\(L_{\mathrm{prim}}\)</span> as <span class="math notranslate nohighlight">\(\mathcal{T}_{\mathrm{prim}}\)</span>, and translation group formed by <span class="math notranslate nohighlight">\(L_{\mathrm{conv}}\)</span> as <span class="math notranslate nohighlight">\(\mathcal{T}_{\mathrm{conv}}\)</span>.
Space group <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> can be written by finite factor group <span class="math notranslate nohighlight">\(\mathcal{G} / \mathcal{T}_{\mathrm{conv}}\)</span> and the centerings:</p>
<div class="math notranslate nohighlight">
\[\mathcal{G} / \mathcal{T}_{\mathrm{prim}}
=
\left\{
    (\mathbf{I}, \mathbf{c}) (\mathbf{W}, \mathbf{w})
    \mid
    (\mathbf{W}, \mathbf{w}) \in \mathcal{G} / \mathcal{T}_{\mathrm{conv}},
    \mathbf{c} \in L_{\mathrm{conv}} / L_{\mathrm{prim}}
\right\}\]</div>
<p>Consider a transformation matrix <span class="math notranslate nohighlight">\(\mathbf{P}\)</span> (corresponds to <code class="code docutils literal notranslate"><span class="pre">Spacegroup.bravais_lattice</span></code>) and origin shift <span class="math notranslate nohighlight">\(\mathbf{p}\)</span> (corresponds to <code class="code docutils literal notranslate"><span class="pre">Spacegroup.origin_shift</span></code>).
This transformation convert the factor group <span class="math notranslate nohighlight">\(\mathcal{G} / \mathcal{T}_{\mathrm{conv}}\)</span> to</p>
<div class="math notranslate nohighlight">
\[\left\{
    (\mathbf{P}, \mathbf{p}) (\mathbf{W}, \mathbf{w}) (\mathbf{P}, \mathbf{p})^{-1}
    \mid
    (\mathbf{W}, \mathbf{w}) \in \mathcal{G} / \mathcal{T}_{\mathrm{conv}}
\right\}\]</div>
<p>If the conventional lattice is properly chosen, each operation in <span class="math notranslate nohighlight">\(\mathcal{G} / \mathcal{T}_{\mathrm{conv}}\)</span> has a unique linear part.
Then, the above transformed factor group has the same order as <span class="math notranslate nohighlight">\(\mathcal{G} / \mathcal{T}_{\mathrm{conv}}\)</span>.</p>
<p>The centering vectors are transformed as</p>
<div class="math notranslate nohighlight">
\[\left\{
    \mathbf{P} (\mathbf{c} + \mathbf{n}) \, \mathrm{mod}\, 1
    \mid
    \mathbf{c} \in L_{\mathrm{conv}} / L_{\mathrm{prim}}, \mathbf{n} \in \mathbb{Z}^{3}
\right\}.\]</div>
<p>When <span class="math notranslate nohighlight">\(|\det \mathbf{P}| = 1\)</span>, the transformed centering vectors give the same conventional lattice.
When <span class="math notranslate nohighlight">\(|\det \mathbf{P}| &gt; 1\)</span>, some centering vectors become duplicated.
When <span class="math notranslate nohighlight">\(|\det \mathbf{P}| &lt; 1\)</span>, we need to additionally find lattice points.
We can confirm the range of <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> to <span class="math notranslate nohighlight">\([0, d)^{3}\)</span>, where <span class="math notranslate nohighlight">\(d\)</span> is maximum denominator of <span class="math notranslate nohighlight">\(\mathbf{P}\)</span>.</p>
</div>
<div class="section" id="transformation-of-magnetic-space-group-mathcal-m">
<h2><a class="toc-backref" href="#id9">Transformation of magnetic space group <span class="math notranslate nohighlight">\(\mathcal{M}\)</span></a><a class="headerlink" href="#transformation-of-magnetic-space-group-mathcal-m" title="Permalink to this headline">¶</a></h2>
<p>We need care for anti-translation.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathcal{M}
    &amp;= \mathcal{D} \sqcup g \mathcal{D} \\
\mathcal{M} / \mathcal{T}_{\mathrm{prim}}(\mathcal{M})
    &amp;=
    \langle g \rangle
    \cdot ( \mathcal{T}_{\mathrm{conv}}(\mathcal{M}) / \mathcal{T}_{\mathrm{prim}}(\mathcal{M}) )
    \cdot ( \mathcal{M} / \langle g \rangle / \mathcal{T}_{\mathrm{conv}}(\mathcal{M}) ) \\
    &amp;=
    \langle g \rangle
    \cdot ( \mathcal{T}_{\mathrm{conv}}(\mathcal{M}) / \mathcal{T}_{\mathrm{prim}}(\mathcal{M}) )
    \cdot ( \mathcal{D} / \mathcal{T}_{\mathrm{conv}}(\mathcal{M}) ) \\\end{split}\]</div>
<p>Each element in factor group <span class="math notranslate nohighlight">\(\mathcal{D} / \mathcal{T}_{\mathrm{conv}}(\mathcal{D})\)</span> has a unique linear part.</p>
</div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#id10">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>[Lit14] D. B. Litvin, Magnetic Group Tables 1-, 2- and 3-Dimensional Magnetic Subperiodic Groups and Magnetic Space Groups (IUCr, 2014).</p>
<p>[SC22] Harold T. Stokes and Branton J. Campbell, [ISO-MAG Table of Magnetic Space Groups](<a class="reference external" href="https://stokes.byu.edu/iso/magneticspacegroups.php">https://stokes.byu.edu/iso/magneticspacegroups.php</a>).</p>
<p>[GPKRC21] J. González-Platas, N. A. Katcho and J. Rodríguez-Carvajal, J. Appl. Crystallogr. 54, 1, 338-342 (2021).</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/magnetic_spacegroup.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2009, Atsushi Togo.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>