<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>C-APIs &#8212; Spglig v.1.16.0</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-sphinx.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Spglib dataset" href="dataset.html" />
    <link rel="prev" title="How to install spglib C-API" href="install.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          spglib</a>
        <span class="navbar-text navbar-version pull-left"><b>1.16</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">How to install spglib C-API</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">C-APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Spglib dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="variable.html">Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="python-spglib.html">Python interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface.html">Rust, Fortran, and Ruby interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="definition.html">Definitions and conventions</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">C-APIs</a><ul>
<li><a class="reference internal" href="#spg-get-major-version-spg-get-minor-version-spg-get-micro-version"><code class="docutils literal notranslate"><span class="pre">spg_get_major_version</span></code>, <code class="docutils literal notranslate"><span class="pre">spg_get_minor_version</span></code>, <code class="docutils literal notranslate"><span class="pre">spg_get_micro_version</span></code></a></li>
<li><a class="reference internal" href="#spg-get-error-code-and-spg-get-error-message"><code class="docutils literal notranslate"><span class="pre">spg_get_error_code</span></code> and <code class="docutils literal notranslate"><span class="pre">spg_get_error_message</span></code></a></li>
<li><a class="reference internal" href="#spg-get-symmetry"><code class="docutils literal notranslate"><span class="pre">spg_get_symmetry</span></code></a></li>
<li><a class="reference internal" href="#spg-get-international"><code class="docutils literal notranslate"><span class="pre">spg_get_international</span></code></a></li>
<li><a class="reference internal" href="#spg-get-schoenflies"><code class="docutils literal notranslate"><span class="pre">spg_get_schoenflies</span></code></a></li>
<li><a class="reference internal" href="#spg-standardize-cell"><code class="docutils literal notranslate"><span class="pre">spg_standardize_cell</span></code></a></li>
<li><a class="reference internal" href="#spg-find-primitive"><code class="docutils literal notranslate"><span class="pre">spg_find_primitive</span></code></a></li>
<li><a class="reference internal" href="#spg-refine-cell"><code class="docutils literal notranslate"><span class="pre">spg_refine_cell</span></code></a></li>
<li><a class="reference internal" href="#spg-get-dataset-and-spg-get-dataset-with-hall-number"><code class="docutils literal notranslate"><span class="pre">spg_get_dataset</span></code> and <code class="docutils literal notranslate"><span class="pre">spg_get_dataset_with_hall_number</span></code></a></li>
<li><a class="reference internal" href="#spg-free-dataset"><code class="docutils literal notranslate"><span class="pre">spg_free_dataset</span></code></a></li>
<li><a class="reference internal" href="#spg-get-spacegroup-type"><code class="docutils literal notranslate"><span class="pre">spg_get_spacegroup_type</span></code></a></li>
<li><a class="reference internal" href="#spg-get-symmetry-from-database"><code class="docutils literal notranslate"><span class="pre">spg_get_symmetry_from_database</span></code></a></li>
<li><a class="reference internal" href="#spg-get-multiplicity"><code class="docutils literal notranslate"><span class="pre">spg_get_multiplicity</span></code></a></li>
<li><a class="reference internal" href="#spg-get-symmetry-with-collinear-spin"><code class="docutils literal notranslate"><span class="pre">spg_get_symmetry_with_collinear_spin</span></code></a></li>
<li><a class="reference internal" href="#spg-niggli-reduce"><code class="docutils literal notranslate"><span class="pre">spg_niggli_reduce</span></code></a></li>
<li><a class="reference internal" href="#spg-delaunay-reduce"><code class="docutils literal notranslate"><span class="pre">spg_delaunay_reduce</span></code></a></li>
<li><a class="reference internal" href="#spg-get-ir-reciprocal-mesh"><code class="docutils literal notranslate"><span class="pre">spg_get_ir_reciprocal_mesh</span></code></a></li>
<li><a class="reference internal" href="#spg-get-stabilized-reciprocal-mesh"><code class="docutils literal notranslate"><span class="pre">spg_get_stabilized_reciprocal_mesh</span></code></a></li>
<li><a class="reference internal" href="#spg-get-hall-number-from-symmetry"><code class="docutils literal notranslate"><span class="pre">spg_get_hall_number_from_symmetry</span></code></a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="c-apis">
<h1>C-APIs<a class="headerlink" href="#c-apis" title="Permalink to this headline">Â¶</a></h1>
<div class="contents local topic" id="list-of-c-apis">
<p class="topic-title">List of C-APIs</p>
<ul class="simple">
<li><p><a class="reference internal" href="#spg-get-major-version-spg-get-minor-version-spg-get-micro-version" id="id1"><code class="docutils literal notranslate"><span class="pre">spg_get_major_version</span></code>, <code class="docutils literal notranslate"><span class="pre">spg_get_minor_version</span></code>, <code class="docutils literal notranslate"><span class="pre">spg_get_micro_version</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-get-error-code-and-spg-get-error-message" id="id2"><code class="docutils literal notranslate"><span class="pre">spg_get_error_code</span></code> and <code class="docutils literal notranslate"><span class="pre">spg_get_error_message</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-get-symmetry" id="id3"><code class="docutils literal notranslate"><span class="pre">spg_get_symmetry</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-get-international" id="id4"><code class="docutils literal notranslate"><span class="pre">spg_get_international</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-get-schoenflies" id="id5"><code class="docutils literal notranslate"><span class="pre">spg_get_schoenflies</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-standardize-cell" id="id6"><code class="docutils literal notranslate"><span class="pre">spg_standardize_cell</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-find-primitive" id="id7"><code class="docutils literal notranslate"><span class="pre">spg_find_primitive</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-refine-cell" id="id8"><code class="docutils literal notranslate"><span class="pre">spg_refine_cell</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-get-dataset-and-spg-get-dataset-with-hall-number" id="id9"><code class="docutils literal notranslate"><span class="pre">spg_get_dataset</span></code> and <code class="docutils literal notranslate"><span class="pre">spg_get_dataset_with_hall_number</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-free-dataset" id="id10"><code class="docutils literal notranslate"><span class="pre">spg_free_dataset</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-get-spacegroup-type" id="id11"><code class="docutils literal notranslate"><span class="pre">spg_get_spacegroup_type</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-get-symmetry-from-database" id="id12"><code class="docutils literal notranslate"><span class="pre">spg_get_symmetry_from_database</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-get-multiplicity" id="id13"><code class="docutils literal notranslate"><span class="pre">spg_get_multiplicity</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-get-symmetry-with-collinear-spin" id="id14"><code class="docutils literal notranslate"><span class="pre">spg_get_symmetry_with_collinear_spin</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-niggli-reduce" id="id15"><code class="docutils literal notranslate"><span class="pre">spg_niggli_reduce</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-delaunay-reduce" id="id16"><code class="docutils literal notranslate"><span class="pre">spg_delaunay_reduce</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-get-ir-reciprocal-mesh" id="id17"><code class="docutils literal notranslate"><span class="pre">spg_get_ir_reciprocal_mesh</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-get-stabilized-reciprocal-mesh" id="id18"><code class="docutils literal notranslate"><span class="pre">spg_get_stabilized_reciprocal_mesh</span></code></a></p></li>
<li><p><a class="reference internal" href="#spg-get-hall-number-from-symmetry" id="id19"><code class="docutils literal notranslate"><span class="pre">spg_get_hall_number_from_symmetry</span></code></a></p></li>
</ul>
</div>
<div class="section" id="spg-get-major-version-spg-get-minor-version-spg-get-micro-version">
<h2><a class="toc-backref" href="#id1"><code class="docutils literal notranslate"><span class="pre">spg_get_major_version</span></code>, <code class="docutils literal notranslate"><span class="pre">spg_get_minor_version</span></code>, <code class="docutils literal notranslate"><span class="pre">spg_get_micro_version</span></code></a><a class="headerlink" href="#spg-get-major-version-spg-get-minor-version-spg-get-micro-version" title="Permalink to this headline">Â¶</a></h2>
<p><strong>New in version 1.8.3</strong></p>
<p>Version number of spglib is obtained. These three functions return
integers that correspond to spglib version [major].[minor].[micro].</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-get-error-code-and-spg-get-error-message">
<h2><a class="toc-backref" href="#id2"><code class="docutils literal notranslate"><span class="pre">spg_get_error_code</span></code> and <code class="docutils literal notranslate"><span class="pre">spg_get_error_message</span></code></a><a class="headerlink" href="#spg-get-error-code-and-spg-get-error-message" title="Permalink to this headline">Â¶</a></h2>
<p><strong>New in version 1.9.5</strong></p>
<p><strong>Be careful. These are not thread safe, i.e., only safely usable
when calling one spglib function per process.</strong></p>
<p>These functions is used to see roughly why spglib failed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SpglibError</span> <span class="n">spg_get_error_code</span><span class="p">(</span><span class="n">void</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">char</span> <span class="o">*</span> <span class="n">spg_get_error_message</span><span class="p">(</span><span class="n">SpglibError</span> <span class="n">spglib_error</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">SpglibError</span></code> type is a enum type as shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">enum</span> <span class="p">{</span>
  <span class="n">SPGLIB_SUCCESS</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">SPGERR_SPACEGROUP_SEARCH_FAILED</span><span class="p">,</span>
  <span class="n">SPGERR_CELL_STANDARDIZATION_FAILED</span><span class="p">,</span>
  <span class="n">SPGERR_SYMMETRY_OPERATION_SEARCH_FAILED</span><span class="p">,</span>
  <span class="n">SPGERR_ATOMS_TOO_CLOSE</span><span class="p">,</span>
  <span class="n">SPGERR_POINTGROUP_NOT_FOUND</span><span class="p">,</span>
  <span class="n">SPGERR_NIGGLI_FAILED</span><span class="p">,</span>
  <span class="n">SPGERR_DELAUNAY_FAILED</span><span class="p">,</span>
  <span class="n">SPGERR_ARRAY_SIZE_SHORTAGE</span><span class="p">,</span>
  <span class="n">SPGERR_NONE</span><span class="p">,</span>
<span class="p">}</span> <span class="n">SpglibError</span><span class="p">;</span>
</pre></div>
</div>
<p>The usage is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SpglibError</span> <span class="n">error</span><span class="p">;</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">spg_get_error_code</span><span class="p">();</span>
<span class="n">printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">spg_get_error_message</span><span class="p">(</span><span class="n">error</span><span class="p">));</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-get-symmetry">
<span id="api-spg-get-symmetry"></span><h2><a class="toc-backref" href="#id3"><code class="docutils literal notranslate"><span class="pre">spg_get_symmetry</span></code></a><a class="headerlink" href="#spg-get-symmetry" title="Permalink to this headline">Â¶</a></h2>
<p>This function finds a set of representative symmetry operations for
primitive cells or its extension with lattice translations for
supercells. 0 is returned if it failed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">spg_get_symmetry</span><span class="p">(</span><span class="nb">int</span> <span class="n">rotation</span><span class="p">[][</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                     <span class="n">double</span> <span class="n">translation</span><span class="p">[][</span><span class="mi">3</span><span class="p">],</span>
                     <span class="n">const</span> <span class="nb">int</span> <span class="n">max_size</span><span class="p">,</span>
                     <span class="n">const</span> <span class="n">double</span> <span class="n">lattice</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                     <span class="n">const</span> <span class="n">double</span> <span class="n">position</span><span class="p">[][</span><span class="mi">3</span><span class="p">],</span>
                     <span class="n">const</span> <span class="nb">int</span> <span class="n">types</span><span class="p">[],</span>
                     <span class="n">const</span> <span class="nb">int</span> <span class="n">num_atom</span><span class="p">,</span>
                     <span class="n">const</span> <span class="n">double</span> <span class="n">symprec</span><span class="p">);</span>
</pre></div>
</div>
<p>The operations are stored in <code class="docutils literal notranslate"><span class="pre">rotation</span></code> and <code class="docutils literal notranslate"><span class="pre">translation</span></code>. The
number of operations is return as the return value. Rotations and
translations are given in fractional coordinates, and <code class="docutils literal notranslate"><span class="pre">rotation[i]</span></code>
and <code class="docutils literal notranslate"><span class="pre">translation[i]</span></code> with same index give a symmetry operations,
i.e., these have to be used together.</p>
<p>As an exceptional case, if a supercell (or non-primitive cell) has the
basis vectors whose lattice breaks crsytallographic point group, the
crystallographic symmetry operations are searched within this broken
symmetry, i.e., at most the crystallographic point group found in this
case is the point group of the lattice. For example, this happens for
the <span class="math notranslate nohighlight">\(2\times 1\times 1\)</span> supercell of a conventional cubic unit
cell. This may not be understandable in crystallographic sense, but is
practically useful treatment for research in computational materials
science.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-get-international">
<h2><a class="toc-backref" href="#id4"><code class="docutils literal notranslate"><span class="pre">spg_get_international</span></code></a><a class="headerlink" href="#spg-get-international" title="Permalink to this headline">Â¶</a></h2>
<p>Space group type is found and returned in international table symbol
to <code class="docutils literal notranslate"><span class="pre">symbol</span></code> and also as a number (return value). 0 is returned if
it failed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">spg_get_international</span><span class="p">(</span><span class="n">char</span> <span class="n">symbol</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span>
                          <span class="n">const</span> <span class="n">double</span> <span class="n">lattice</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                          <span class="n">const</span> <span class="n">double</span> <span class="n">position</span><span class="p">[][</span><span class="mi">3</span><span class="p">],</span>
                          <span class="n">const</span> <span class="nb">int</span> <span class="n">types</span><span class="p">[],</span>
                          <span class="n">const</span> <span class="nb">int</span> <span class="n">num_atom</span><span class="p">,</span>
                          <span class="n">const</span> <span class="n">double</span> <span class="n">symprec</span><span class="p">);</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-get-schoenflies">
<h2><a class="toc-backref" href="#id5"><code class="docutils literal notranslate"><span class="pre">spg_get_schoenflies</span></code></a><a class="headerlink" href="#spg-get-schoenflies" title="Permalink to this headline">Â¶</a></h2>
<p>Space group type is found and returned in schoenflies to <code class="docutils literal notranslate"><span class="pre">symbol</span></code>
and also as a number (return value). 0 is returned if it failed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">spg_get_schoenflies</span><span class="p">(</span><span class="n">char</span> <span class="n">symbol</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span>
                        <span class="n">const</span> <span class="n">double</span> <span class="n">lattice</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">const</span> <span class="n">double</span> <span class="n">position</span><span class="p">[][</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">const</span> <span class="nb">int</span> <span class="n">types</span><span class="p">[],</span>
                        <span class="n">const</span> <span class="nb">int</span> <span class="n">num_atom</span><span class="p">,</span>
                        <span class="n">const</span> <span class="n">double</span> <span class="n">symprec</span><span class="p">);</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-standardize-cell">
<h2><a class="toc-backref" href="#id6"><code class="docutils literal notranslate"><span class="pre">spg_standardize_cell</span></code></a><a class="headerlink" href="#spg-standardize-cell" title="Permalink to this headline">Â¶</a></h2>
<p>The standardized unit cell (see <a class="reference internal" href="definition.html#def-standardized-unit-cell"><span class="std std-ref">Spglib conventions of standardized unit cell</span></a>) is
generated from an input unit cell structure and its symmetry found by
the symmetry search. The choice of the setting for each space group
type is as explained for <a class="reference internal" href="#api-spg-get-dataset"><span class="std std-ref">spg_get_dataset</span></a>.
Usually <code class="docutils literal notranslate"><span class="pre">to_primitive=0</span></code> and <code class="docutils literal notranslate"><span class="pre">no_idealize=0</span></code> are recommended to
set and this setting results in the same behavior as
<code class="docutils literal notranslate"><span class="pre">spg_refine_cell</span></code>. 0 is returned if it failed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">spg_standardize_cell</span><span class="p">(</span><span class="n">double</span> <span class="n">lattice</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                         <span class="n">double</span> <span class="n">position</span><span class="p">[][</span><span class="mi">3</span><span class="p">],</span>
                         <span class="nb">int</span> <span class="n">types</span><span class="p">[],</span>
                         <span class="n">const</span> <span class="nb">int</span> <span class="n">num_atom</span><span class="p">,</span>
                         <span class="n">const</span> <span class="nb">int</span> <span class="n">to_primitive</span><span class="p">,</span>
                         <span class="n">const</span> <span class="nb">int</span> <span class="n">no_idealize</span><span class="p">,</span>
                         <span class="n">const</span> <span class="n">double</span> <span class="n">symprec</span><span class="p">);</span>
</pre></div>
</div>
<p>Number of atoms in the found standardized unit (primitive) cell is
returned.</p>
<p><code class="docutils literal notranslate"><span class="pre">to_primitive=1</span></code> is used to create the standardized primitive cell
with the transformation matricies shown at
<a class="reference internal" href="definition.html#def-standardized-primitive-cell"><span class="std std-ref">Transformation to the primitive cell</span></a>, otherwise <code class="docutils literal notranslate"><span class="pre">to_primitive=0</span></code>
must be specified. The found basis vectors and
atomic point coordinates and types are overwritten in <code class="docutils literal notranslate"><span class="pre">lattice</span></code>,
<code class="docutils literal notranslate"><span class="pre">position</span></code>, and <code class="docutils literal notranslate"><span class="pre">types</span></code>, respectively. Therefore with
<code class="docutils literal notranslate"><span class="pre">to_primitive=0</span></code>, at a maximum four times larger array size for
<code class="docutils literal notranslate"><span class="pre">position</span></code> and <code class="docutils literal notranslate"><span class="pre">types</span></code> than the those size of the input unit cell
is required to store a standardized unit cell with face centring found
in the case that the input unit cell is a primitive cell.</p>
<p><code class="docutils literal notranslate"><span class="pre">no_idealize=0</span></code> is used to idealize the lengths and angles of basis
vectors with adjusting the positions of atoms to nearest exact
positions according to crystal symmetry. However the crystal can be
rotated in Cartesian coordinates by the idealization of the basis
vectors.  <code class="docutils literal notranslate"><span class="pre">no_idealize=1</span></code> disables this. The detail of the
idealization (<code class="docutils literal notranslate"><span class="pre">no_idealize=0</span></code>) is written at
<a class="reference internal" href="definition.html#def-idealize-cell"><span class="std std-ref">Idealization of unit cell structure</span></a>. <code class="docutils literal notranslate"><span class="pre">no_idealize=1</span></code> may be useful when we want
to leave basis vectors and atomic positions in Cartesianl coordinates
fixed.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-find-primitive">
<h2><a class="toc-backref" href="#id7"><code class="docutils literal notranslate"><span class="pre">spg_find_primitive</span></code></a><a class="headerlink" href="#spg-find-primitive" title="Permalink to this headline">Â¶</a></h2>
<p><strong>Behavior is changed. This function is now a shortcut of</strong>
<code class="docutils literal notranslate"><span class="pre">spg_standardize_cell</span></code> <strong>with</strong>
<code class="docutils literal notranslate"><span class="pre">to_primitive=1</span></code> <strong>and</strong> <code class="docutils literal notranslate"><span class="pre">no_idealize=0</span></code>.</p>
<p>A primitive cell is found from an input unit cell. 0 is returned if it
failed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">spg_find_primitive</span><span class="p">(</span><span class="n">double</span> <span class="n">lattice</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                       <span class="n">double</span> <span class="n">position</span><span class="p">[][</span><span class="mi">3</span><span class="p">],</span>
                       <span class="nb">int</span> <span class="n">types</span><span class="p">[],</span>
                       <span class="n">const</span> <span class="nb">int</span> <span class="n">num_atom</span><span class="p">,</span>
                       <span class="n">const</span> <span class="n">double</span> <span class="n">symprec</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">lattice</span></code>, <code class="docutils literal notranslate"><span class="pre">position</span></code>, and <code class="docutils literal notranslate"><span class="pre">types</span></code> are overwritten. Number of
atoms in the found primitive cell is returned. The crystal can be
rotated by this function. To avoid this, please use
<code class="docutils literal notranslate"><span class="pre">spg_standardize_cell</span></code> with <code class="docutils literal notranslate"><span class="pre">to_primitive=1</span></code> and <code class="docutils literal notranslate"><span class="pre">no_idealize=1</span></code>
although the crystal structure is not idealized.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-refine-cell">
<h2><a class="toc-backref" href="#id8"><code class="docutils literal notranslate"><span class="pre">spg_refine_cell</span></code></a><a class="headerlink" href="#spg-refine-cell" title="Permalink to this headline">Â¶</a></h2>
<p><strong>This function exists for backward compatibility since it is same
as</strong> <code class="docutils literal notranslate"><span class="pre">spg_standardize_cell</span></code> <strong>with</strong> <code class="docutils literal notranslate"><span class="pre">to_primitive=0</span></code> <strong>and</strong>
<code class="docutils literal notranslate"><span class="pre">no_idealize=0</span></code>.</p>
<p>The standardized crystal structure is obtained from a non-standard
crystal structure which may be slightly distorted within a symmetry
recognition tolerance, or whose primitive vectors are differently
chosen, etc. 0 is returned if it failed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">spg_refine_cell</span><span class="p">(</span><span class="n">double</span> <span class="n">lattice</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                    <span class="n">double</span> <span class="n">position</span><span class="p">[][</span><span class="mi">3</span><span class="p">],</span>
                    <span class="nb">int</span> <span class="n">types</span><span class="p">[],</span>
                    <span class="n">const</span> <span class="nb">int</span> <span class="n">num_atom</span><span class="p">,</span>
                    <span class="n">const</span> <span class="n">double</span> <span class="n">symprec</span><span class="p">);</span>
</pre></div>
</div>
<p>The calculated standardized lattice and atomic positions overwrites
<code class="docutils literal notranslate"><span class="pre">lattice</span></code>, <code class="docutils literal notranslate"><span class="pre">position</span></code>, and <code class="docutils literal notranslate"><span class="pre">types</span></code>. The number of atoms in the
standardized unit cell is returned as the return value. When the input
unit cell is a primitive cell and is the face centring symmetry, the
number of the atoms returned becomes four times large. Since this
function does not have any means of checking the array size (memory
space) of these variables, the array size (memory space) for
<code class="docutils literal notranslate"><span class="pre">position</span></code> and <code class="docutils literal notranslate"><span class="pre">types</span></code> should be prepared <strong>four times more</strong> than
those required for the input unit cell in general.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-get-dataset-and-spg-get-dataset-with-hall-number">
<span id="api-spg-get-dataset"></span><h2><a class="toc-backref" href="#id9"><code class="docutils literal notranslate"><span class="pre">spg_get_dataset</span></code> and <code class="docutils literal notranslate"><span class="pre">spg_get_dataset_with_hall_number</span></code></a><a class="headerlink" href="#spg-get-dataset-and-spg-get-dataset-with-hall-number" title="Permalink to this headline">Â¶</a></h2>
<p><strong>Changed in version 1.8.1</strong></p>
<p>For an input unit cell structure, symmetry operations of the crystal
are searched. Then they are compared with the crsytallographic
database and the space group type is determined.  The result is
returned as the <code class="docutils literal notranslate"><span class="pre">SpglibDataset</span></code> structure as a dataset.</p>
<p>The detail of the dataset is given at <a class="reference internal" href="dataset.html#spglib-dataset"><span class="std std-ref">Spglib dataset</span></a>.</p>
<p>Dataset corresponding to the space group type in the standard setting
is obtained by <code class="docutils literal notranslate"><span class="pre">spg_get_dataset</span></code>. Here the standard setting means
the first top one among the Hall symbols listed for each space group
type. For example, H setting (hexagonal lattice) is chosen for
rhombohedral crystals. <code class="docutils literal notranslate"><span class="pre">spg_get_dataset_with_hall_number</span></code> explained
below is used to choose different settings such as R setting of
rhombohedral crystals. If this symmetry search fails, <code class="docutils literal notranslate"><span class="pre">NULL</span></code> is
returned in version 1.8.1 or later (spacegroup_number = 0 is returned
in the previous versions). In this function, the other
crystallographic setting is not obtained.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SpglibDataset</span> <span class="o">*</span> <span class="n">spg_get_dataset</span><span class="p">(</span><span class="n">const</span> <span class="n">double</span> <span class="n">lattice</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                                <span class="n">const</span> <span class="n">double</span> <span class="n">position</span><span class="p">[][</span><span class="mi">3</span><span class="p">],</span>
                                <span class="n">const</span> <span class="nb">int</span> <span class="n">types</span><span class="p">[],</span>
                                <span class="n">const</span> <span class="nb">int</span> <span class="n">num_atom</span><span class="p">,</span>
                                <span class="n">const</span> <span class="n">double</span> <span class="n">symprec</span><span class="p">);</span>
</pre></div>
</div>
<p>To specify the other crystallographic choice (setting, origin, axis,
or cell choice), <code class="docutils literal notranslate"><span class="pre">spg_get_dataset_with_hall_number</span></code> is used.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SpglibDataset</span> <span class="o">*</span> <span class="n">spg_get_dataset_with_hall_number</span><span class="p">(</span><span class="n">SPGCONST</span> <span class="n">double</span> <span class="n">lattice</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                                                 <span class="n">SPGCONST</span> <span class="n">double</span> <span class="n">position</span><span class="p">[][</span><span class="mi">3</span><span class="p">],</span>
                                                 <span class="n">const</span> <span class="nb">int</span> <span class="n">types</span><span class="p">[],</span>
                                                 <span class="n">const</span> <span class="nb">int</span> <span class="n">num_atom</span><span class="p">,</span>
                                                 <span class="n">const</span> <span class="nb">int</span> <span class="n">hall_number</span><span class="p">,</span>
                                                 <span class="n">const</span> <span class="n">double</span> <span class="n">symprec</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">hall_number</span></code> is used to specify the choice. The possible
choices and those serial numbers are found at <a class="reference external" href="http://pmsl.planet.sci.kobe-u.ac.jp/~seto/?page_id=37&amp;lang=en">list of space groups
(Setoâs web site)</a>.
The crystal structure has to possess the space-group type of the Hall
symbol. If the symmetry search fails or the specified <code class="docutils literal notranslate"><span class="pre">hall_number</span></code>
is not in the list of Hall symbols for the space group type of the
crystal structure, <code class="docutils literal notranslate"><span class="pre">spacegroup_number</span></code> in the <code class="docutils literal notranslate"><span class="pre">SpglibDataset</span></code>
structure is set 0.</p>
<p>Finally, its allocated memory space must be freed by calling
<code class="docutils literal notranslate"><span class="pre">spg_free_dataset</span></code>.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-free-dataset">
<h2><a class="toc-backref" href="#id10"><code class="docutils literal notranslate"><span class="pre">spg_free_dataset</span></code></a><a class="headerlink" href="#spg-free-dataset" title="Permalink to this headline">Â¶</a></h2>
<p>Allocated memoery space of the C-structure of <code class="docutils literal notranslate"><span class="pre">SpglibDataset</span></code> is
freed by calling <code class="docutils literal notranslate"><span class="pre">spg_free_dataset</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">spg_free_dataset</span><span class="p">(</span><span class="n">SpglibDataset</span> <span class="o">*</span><span class="n">dataset</span><span class="p">);</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-get-spacegroup-type">
<span id="api-spg-spacegroup-type"></span><h2><a class="toc-backref" href="#id11"><code class="docutils literal notranslate"><span class="pre">spg_get_spacegroup_type</span></code></a><a class="headerlink" href="#spg-get-spacegroup-type" title="Permalink to this headline">Â¶</a></h2>
<p><strong>Changed at version 1.9.4: Some members are added and the member name âsettingâ is changed to âchoiceâ.</strong></p>
<p>This function allows to directly access to the space-group-type
database in spglib (spg_database.c). To specify the space group type
with a specific choice, <code class="docutils literal notranslate"><span class="pre">hall_number</span></code> is used. The definition of
<code class="docutils literal notranslate"><span class="pre">hall_number</span></code> is found at
<a class="reference internal" href="dataset.html#dataset-spg-get-dataset-spacegroup-type"><span class="std std-ref">Space group type</span></a>.
<code class="docutils literal notranslate"><span class="pre">number</span> <span class="pre">=</span> <span class="pre">0</span></code> is returned when it failed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SpglibSpacegroupType</span> <span class="n">spg_get_spacegroup_type</span><span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="n">hall_number</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">SpglibSpacegroupType</span></code> structure is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">struct</span> <span class="p">{</span>
  <span class="nb">int</span> <span class="n">number</span><span class="p">;</span>
  <span class="n">char</span> <span class="n">international_short</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span>
  <span class="n">char</span> <span class="n">international_full</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>
  <span class="n">char</span> <span class="n">international</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
  <span class="n">char</span> <span class="n">schoenflies</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
  <span class="n">char</span> <span class="n">hall_symbol</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>
  <span class="n">char</span> <span class="n">choice</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
  <span class="n">char</span> <span class="n">pointgroup_schoenflies</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
  <span class="n">char</span> <span class="n">pointgroup_international</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
  <span class="nb">int</span> <span class="n">arithmetic_crystal_class_number</span><span class="p">;</span>
  <span class="n">char</span> <span class="n">arithmetic_crystal_class_symbol</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
<span class="p">}</span> <span class="n">SpglibSpacegroupType</span><span class="p">;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-get-symmetry-from-database">
<h2><a class="toc-backref" href="#id12"><code class="docutils literal notranslate"><span class="pre">spg_get_symmetry_from_database</span></code></a><a class="headerlink" href="#spg-get-symmetry-from-database" title="Permalink to this headline">Â¶</a></h2>
<p>This function allows to directly access to the space group operations
in the spglib database (spg_database.c). To specify the space group
type with a specific choice, <code class="docutils literal notranslate"><span class="pre">hall_number</span></code> is used. The definition
of <code class="docutils literal notranslate"><span class="pre">hall_number</span></code> is found at
<a class="reference internal" href="dataset.html#dataset-spg-get-dataset-spacegroup-type"><span class="std std-ref">Space group type</span></a>. 0 is returned when it
failed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">spg_get_symmetry_from_database</span><span class="p">(</span><span class="nb">int</span> <span class="n">rotations</span><span class="p">[</span><span class="mi">192</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                                   <span class="n">double</span> <span class="n">translations</span><span class="p">[</span><span class="mi">192</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                                   <span class="n">const</span> <span class="nb">int</span> <span class="n">hall_number</span><span class="p">);</span>
</pre></div>
</div>
<p>The returned value is the number of space group operations. The space
group operations are stored in <code class="docutils literal notranslate"><span class="pre">rotations</span></code> and <code class="docutils literal notranslate"><span class="pre">translations</span></code>.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-get-multiplicity">
<h2><a class="toc-backref" href="#id13"><code class="docutils literal notranslate"><span class="pre">spg_get_multiplicity</span></code></a><a class="headerlink" href="#spg-get-multiplicity" title="Permalink to this headline">Â¶</a></h2>
<p>This function returns exact number of symmetry operations. 0 is
returned when it failed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">spg_get_multiplicity</span><span class="p">(</span><span class="n">const</span> <span class="n">double</span> <span class="n">lattice</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                         <span class="n">const</span> <span class="n">double</span> <span class="n">position</span><span class="p">[][</span><span class="mi">3</span><span class="p">],</span>
                         <span class="n">const</span> <span class="nb">int</span> <span class="n">types</span><span class="p">[],</span>
                         <span class="n">const</span> <span class="nb">int</span> <span class="n">num_atom</span><span class="p">,</span>
                         <span class="n">const</span> <span class="n">double</span> <span class="n">symprec</span><span class="p">);</span>
</pre></div>
</div>
<p>This function may be used in advance to allocate memoery space for
symmetry operations.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-get-symmetry-with-collinear-spin">
<h2><a class="toc-backref" href="#id14"><code class="docutils literal notranslate"><span class="pre">spg_get_symmetry_with_collinear_spin</span></code></a><a class="headerlink" href="#spg-get-symmetry-with-collinear-spin" title="Permalink to this headline">Â¶</a></h2>
<p>This function finds symmetry operations with collinear polarizations
(spins) on atoms. Except for the argument of <code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">double</span> <span class="pre">spins[]</span></code>,
the usage is basically the same as <code class="docutils literal notranslate"><span class="pre">spg_get_symmetry</span></code>, but as an
output, <code class="docutils literal notranslate"><span class="pre">equivalent_atoms</span></code> are obtained. The size of this array is
the same of <code class="docutils literal notranslate"><span class="pre">num_atom</span></code>. See <a class="reference internal" href="dataset.html#dataset-spg-get-dataset-site-symmetry"><span class="std std-ref">Wyckoff positions and symmetrically equivalent atoms</span></a>
for the definition <code class="docutils literal notranslate"><span class="pre">equivalent_atoms</span></code>. 0 is returned when it failed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">spg_get_symmetry_with_collinear_spin</span><span class="p">(</span><span class="nb">int</span> <span class="n">rotation</span><span class="p">[][</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                                         <span class="n">double</span> <span class="n">translation</span><span class="p">[][</span><span class="mi">3</span><span class="p">],</span>
                                         <span class="nb">int</span> <span class="n">equivalent_atoms</span><span class="p">[],</span>
                                         <span class="n">const</span> <span class="nb">int</span> <span class="n">max_size</span><span class="p">,</span>
                                         <span class="n">SPGCONST</span> <span class="n">double</span> <span class="n">lattice</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                                         <span class="n">SPGCONST</span> <span class="n">double</span> <span class="n">position</span><span class="p">[][</span><span class="mi">3</span><span class="p">],</span>
                                         <span class="n">const</span> <span class="nb">int</span> <span class="n">types</span><span class="p">[],</span>
                                         <span class="n">const</span> <span class="n">double</span> <span class="n">spins</span><span class="p">[],</span>
                                         <span class="n">const</span> <span class="nb">int</span> <span class="n">num_atom</span><span class="p">,</span>
                                         <span class="n">const</span> <span class="n">double</span> <span class="n">symprec</span><span class="p">);</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-niggli-reduce">
<h2><a class="toc-backref" href="#id15"><code class="docutils literal notranslate"><span class="pre">spg_niggli_reduce</span></code></a><a class="headerlink" href="#spg-niggli-reduce" title="Permalink to this headline">Â¶</a></h2>
<p>Niggli reduction is applied to input basis vectors <code class="docutils literal notranslate"><span class="pre">lattice</span></code> and the
reduced basis vectors are overwritten to <code class="docutils literal notranslate"><span class="pre">lattice</span></code>. 0 is returned if
it failed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">spg_niggli_reduce</span><span class="p">(</span><span class="n">double</span> <span class="n">lattice</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">const</span> <span class="n">double</span> <span class="n">symprec</span><span class="p">);</span>
</pre></div>
</div>
<p>The transformation from original basis vectors <span class="math notranslate nohighlight">\(( \mathbf{a}
\; \mathbf{b} \; \mathbf{c} )\)</span> to final basis vectors <span class="math notranslate nohighlight">\((
\mathbf{a}' \; \mathbf{b}' \; \mathbf{c}' )\)</span> is achieved by linear
combination of basis vectors with integer coefficients without
rotating coordinates. Therefore the transformation matrix is obtained
by <span class="math notranslate nohighlight">\(\boldsymbol{P} = ( \mathbf{a} \; \mathbf{b} \; \mathbf{c} )
( \mathbf{a}' \; \mathbf{b}' \; \mathbf{c}' )^{-1}\)</span> and the matrix
elements have to be almost integers.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-delaunay-reduce">
<h2><a class="toc-backref" href="#id16"><code class="docutils literal notranslate"><span class="pre">spg_delaunay_reduce</span></code></a><a class="headerlink" href="#spg-delaunay-reduce" title="Permalink to this headline">Â¶</a></h2>
<p>Delaunay reduction is applied to input basis vectors <code class="docutils literal notranslate"><span class="pre">lattice</span></code> and
the reduced basis vectors are overwritten to <code class="docutils literal notranslate"><span class="pre">lattice</span></code>. 0 is
returned if it failed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">spg_delaunay_reduce</span><span class="p">(</span><span class="n">double</span> <span class="n">lattice</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">const</span> <span class="n">double</span> <span class="n">symprec</span><span class="p">);</span>
</pre></div>
</div>
<p>The transformation from original basis vectors <span class="math notranslate nohighlight">\(( \mathbf{a}
\; \mathbf{b} \; \mathbf{c} )\)</span> to final basis vectors <span class="math notranslate nohighlight">\((
\mathbf{a}' \; \mathbf{b}' \; \mathbf{c}' )\)</span> is achieved by linear
combination of basis vectors with integer coefficients without
rotating coordinates. Therefore the transformation matrix is obtained
by <span class="math notranslate nohighlight">\(\boldsymbol{P} = ( \mathbf{a} \; \mathbf{b} \; \mathbf{c} )
( \mathbf{a}' \; \mathbf{b}' \; \mathbf{c}' )^{-1}\)</span> and the matrix
elements have to be almost integers.</p>
</div>
<div class="section" id="spg-get-ir-reciprocal-mesh">
<h2><a class="toc-backref" href="#id17"><code class="docutils literal notranslate"><span class="pre">spg_get_ir_reciprocal_mesh</span></code></a><a class="headerlink" href="#spg-get-ir-reciprocal-mesh" title="Permalink to this headline">Â¶</a></h2>
<p>Irreducible reciprocal grid points are searched from uniform mesh grid
points specified by <code class="docutils literal notranslate"><span class="pre">mesh</span></code> and <code class="docutils literal notranslate"><span class="pre">is_shift</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">spg_get_ir_reciprocal_mesh</span><span class="p">(</span><span class="nb">int</span> <span class="n">grid_address</span><span class="p">[][</span><span class="mi">3</span><span class="p">],</span>
                               <span class="nb">int</span> <span class="nb">map</span><span class="p">[],</span>
                               <span class="n">const</span> <span class="nb">int</span> <span class="n">mesh</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                               <span class="n">const</span> <span class="nb">int</span> <span class="n">is_shift</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                               <span class="n">const</span> <span class="nb">int</span> <span class="n">is_time_reversal</span><span class="p">,</span>
                               <span class="n">const</span> <span class="n">double</span> <span class="n">lattice</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                               <span class="n">const</span> <span class="n">double</span> <span class="n">position</span><span class="p">[][</span><span class="mi">3</span><span class="p">],</span>
                               <span class="n">const</span> <span class="nb">int</span> <span class="n">types</span><span class="p">[],</span>
                               <span class="n">const</span> <span class="nb">int</span> <span class="n">num_atom</span><span class="p">,</span>
                               <span class="n">const</span> <span class="n">double</span> <span class="n">symprec</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">mesh</span></code> stores three integers. Reciprocal primitive vectors are
divided by the number stored in <code class="docutils literal notranslate"><span class="pre">mesh</span></code> with (0,0,0) point
centering. The center of grid mesh is shifted +1/2 of a grid spacing
along corresponding reciprocal axis by setting 1 to a <code class="docutils literal notranslate"><span class="pre">is_shift</span></code>
element. No grid mesh shift is made if 0 is set for <code class="docutils literal notranslate"><span class="pre">is_shift</span></code>.</p>
<p>The reducible uniform grid points are returned in fractional coordinates
as <code class="docutils literal notranslate"><span class="pre">grid_address</span></code>. A map between reducible and irreducible points are
returned as <code class="docutils literal notranslate"><span class="pre">map</span></code> as in the indices of <code class="docutils literal notranslate"><span class="pre">grid_address</span></code>. The number of
the irreducible k-points are returned as the return value.  The time
reversal symmetry is imposed by setting <code class="docutils literal notranslate"><span class="pre">is_time_reversal</span></code> 1.</p>
<p>Grid points are stored in the order that runs left most element
first, e.g. (4x4x4 mesh).:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span><span class="p">]</span>
 <span class="p">[</span> <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span><span class="p">]</span>
 <span class="p">[</span> <span class="mi">2</span>  <span class="mi">0</span>  <span class="mi">0</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span><span class="p">]</span>
 <span class="p">[</span> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span><span class="p">]</span>
 <span class="p">[</span> <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">0</span><span class="p">]</span>
 <span class="p">[</span> <span class="mi">2</span>  <span class="mi">1</span>  <span class="mi">0</span><span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">0</span><span class="p">]</span>
 <span class="o">....</span>      <span class="p">]</span>
</pre></div>
</div>
<p>where the first index runs first.  k-qpoints are calculated by
<code class="docutils literal notranslate"><span class="pre">(grid_address</span> <span class="pre">+</span> <span class="pre">is_shift</span> <span class="pre">/</span> <span class="pre">2)</span> <span class="pre">/</span> <span class="pre">mesh</span></code>. A grid point index is
recovered from <code class="docutils literal notranslate"><span class="pre">grid_address</span></code> by <code class="docutils literal notranslate"><span class="pre">numpy.dot(grid_address</span> <span class="pre">%</span> <span class="pre">mesh,</span>
<span class="pre">[1,</span> <span class="pre">mesh[0],</span> <span class="pre">mesh[0]</span> <span class="pre">*</span> <span class="pre">mesh[1]])</span></code> in Python-numpy notation, where
<code class="docutils literal notranslate"><span class="pre">%</span></code> always returns non-negative integers. The order of
<code class="docutils literal notranslate"><span class="pre">grid_address</span></code> can be changed so that the last index runs first by
setting the macro <code class="docutils literal notranslate"><span class="pre">GRID_ORDER_XYZ</span></code> in <code class="docutils literal notranslate"><span class="pre">kpoint.c</span></code>. In this case the
grid point index is recovered by <code class="docutils literal notranslate"><span class="pre">numpy.dot(grid_address</span> <span class="pre">%</span> <span class="pre">mesh,</span>
<span class="pre">[mesh[2]</span> <span class="pre">*</span> <span class="pre">mesh[1],</span> <span class="pre">mesh[2],</span> <span class="pre">1])</span></code>.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-get-stabilized-reciprocal-mesh">
<h2><a class="toc-backref" href="#id18"><code class="docutils literal notranslate"><span class="pre">spg_get_stabilized_reciprocal_mesh</span></code></a><a class="headerlink" href="#spg-get-stabilized-reciprocal-mesh" title="Permalink to this headline">Â¶</a></h2>
<p>The irreducible k-points are searched from unique k-point mesh grids
from direct (real space) basis vectors and a set of rotation parts of
symmetry operations in direct space with one or multiple
stabilizers.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">spg_get_stabilized_reciprocal_mesh</span><span class="p">(</span><span class="nb">int</span> <span class="n">grid_address</span><span class="p">[][</span><span class="mi">3</span><span class="p">],</span>
                                       <span class="nb">int</span> <span class="nb">map</span><span class="p">[],</span>
                                       <span class="n">const</span> <span class="nb">int</span> <span class="n">mesh</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                                       <span class="n">const</span> <span class="nb">int</span> <span class="n">is_shift</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                                       <span class="n">const</span> <span class="nb">int</span> <span class="n">is_time_reversal</span><span class="p">,</span>
                                       <span class="n">const</span> <span class="nb">int</span> <span class="n">num_rot</span><span class="p">,</span>
                                       <span class="n">const</span> <span class="nb">int</span> <span class="n">rotations</span><span class="p">[][</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                                       <span class="n">const</span> <span class="nb">int</span> <span class="n">num_q</span><span class="p">,</span>
                                       <span class="n">const</span> <span class="n">double</span> <span class="n">qpoints</span><span class="p">[][</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p>The stabilizers are written in fractional coordinates. Number of the
stabilizers are given by <code class="docutils literal notranslate"><span class="pre">num_q</span></code>. Symmetrically equivalent k-points
(stars) in fractional coordinates are stored in <code class="docutils literal notranslate"><span class="pre">map</span></code> as indices of
<code class="docutils literal notranslate"><span class="pre">grid_address</span></code>. The number of reduced k-points with the stabilizers
are returned as the return value.</p>
<p>This function can be used to obtain all mesh grid points by setting
<code class="docutils literal notranslate"><span class="pre">num_rot</span> <span class="pre">=</span> <span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">rotations</span> <span class="pre">=</span> <span class="pre">{{1,</span> <span class="pre">0,</span> <span class="pre">0},</span> <span class="pre">{0,</span> <span class="pre">1,</span> <span class="pre">0},</span> <span class="pre">{0,</span> <span class="pre">0,</span> <span class="pre">1}}</span></code>,
<code class="docutils literal notranslate"><span class="pre">num_q</span> <span class="pre">=</span> <span class="pre">1</span></code>, and <code class="docutils literal notranslate"><span class="pre">qpoints</span> <span class="pre">=</span> <span class="pre">{0,</span> <span class="pre">0,</span> <span class="pre">0}</span></code>.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="spg-get-hall-number-from-symmetry">
<h2><a class="toc-backref" href="#id19"><code class="docutils literal notranslate"><span class="pre">spg_get_hall_number_from_symmetry</span></code></a><a class="headerlink" href="#spg-get-hall-number-from-symmetry" title="Permalink to this headline">Â¶</a></h2>
<p><strong>experimental</strong></p>
<p>Return one of <code class="docutils literal notranslate"><span class="pre">hall_number</span></code> corresponding to a space-group type of the given set of symmetry operations.
When multiple <code class="docutils literal notranslate"><span class="pre">hall_number</span></code> exist for the space-group type, the smallest one (the first description of the space-group type in International Tables for Crystallography) is chosen.
The definition of <code class="docutils literal notranslate"><span class="pre">hall_number</span></code> is found at
<a class="reference internal" href="dataset.html#dataset-spg-get-dataset-spacegroup-type"><span class="std std-ref">Space group type</span></a> and the corresponding
space-group-type information is obtained through
<a class="reference internal" href="#api-spg-spacegroup-type"><span class="std std-ref">spg_get_spacegroup_type</span></a>.</p>
<p>This is expected to work well for the set of symmetry operations whose
distortion is small. The aim of making this feature is to find
space-group-type for the set of symmetry operations given by the other
source than spglib.</p>
<p>Note that the definition of <code class="docutils literal notranslate"><span class="pre">symprec</span></code> is
different from usual one, but is given in the fractional
coordinates and so it should be small like <code class="docutils literal notranslate"><span class="pre">1e-5</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">spg_get_hall_number_from_symmetry</span><span class="p">(</span><span class="n">SPGCONST</span> <span class="nb">int</span> <span class="n">rotation</span><span class="p">[][</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span>
                                      <span class="n">SPGCONST</span> <span class="n">double</span> <span class="n">translation</span><span class="p">[][</span><span class="mi">3</span><span class="p">],</span>
                                      <span class="n">const</span> <span class="nb">int</span> <span class="n">num_operations</span><span class="p">,</span>
                                      <span class="n">const</span> <span class="n">double</span> <span class="n">symprec</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="_sources/api.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2009, Atsushi Togo.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.3.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>